---
title: "Mapping a network of women in demography"
author: "Monica Alexander"
date: "2021-02-21"
output: 
  html_document:
    number_sections: false
---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/leaflet/leaflet.css" rel="stylesheet" />
<script src="/rmarkdown-libs/leaflet/leaflet.js"></script>
<link href="/rmarkdown-libs/leafletfix/leafletfix.css" rel="stylesheet" />
<script src="/rmarkdown-libs/Proj4Leaflet/proj4-compressed.js"></script>
<script src="/rmarkdown-libs/Proj4Leaflet/proj4leaflet.js"></script>
<link href="/rmarkdown-libs/rstudio_leaflet/rstudio_leaflet.css" rel="stylesheet" />
<script src="/rmarkdown-libs/leaflet-binding/leaflet.js"></script>


<p>Last summer, I ran a demography reading course and one of the students noticed that I didn’t cite very many scholars who were women. She was absolutely right, so I decided to start putting together a <a href="https://www.monicaalexander.com/women_scholars/">list of active scholars</a> in demography who identify as women or other gender minorities. Initially some friends and I put together about 60 names, and then I put it out on Twitter — now it’s over 300 names long. It’s been a great way to discover new scholars and papers.</p>
<p>It was fun to see the list grow as people saw the tweets, and interesting that additions would tend to happen in geographic clusters as different people found it and then suggested their colleagues. I was curious to see how the locations of all these scholars mapped on a global scale. The list was never meant to be comprehensive and I am under no false pretenses that it is representative, but thought it might be interesting all the same.</p>
<p>The issue is that, perhaps rather foolishly, I had not been collecting or recording people’s affiliations in any systematic way. Rather than going through the list and manually entering everyone’s affiliations, I decided to use it as an excuse to write some R code. It is reading week after all and I’m only a little (read: extremely, very much) behind with work.</p>
<p>This post summarizes what I did to map affiliations of women in demography. In particular I grabbed (most) affiliations from Google Scholar with the help of the <code>rvest</code> package, and geocoded these affiliations with the help of the <code>tidygeocoder</code> package.</p>
<div id="getting-the-affiliations-through-google-scholar" class="section level1">
<h1>Getting the affiliations through Google Scholar</h1>
<p>The first step is to get a list of the universities or other institutions that people are affiliated with. I decided my best best to do this in a programmatic way was probably through Google Scholar. Most people have a Google Scholar page these days, so I only had to manually enter a few people’s affiliations (probably ~15 in total).</p>
<p>Here’s an example of how I did it. I’m using <a href="https://twitter.com/les_ja">Leslie Root</a> as an example, who is a great demographer and friend, and would probably be mildly embarrassed/irritated if she ever reads this post.</p>
<p>The first step is to define the URL that we want to look up. In particular, this is the Google Scholar author search page.</p>
<pre class="r"><code>this_name &lt;- &quot;root,leslie&quot;
search_page &lt;- paste(
  &quot;http://scholar.google.com/
  citations?hl=en&amp;view_op=search_authors&amp;mauthors=&quot;, 
  this_name,
  sep=&quot;&quot;)</code></pre>
<p>Once the page is defined, we can use the <code>read_html</code> function from the <code>rvest</code> package to get the contents of that page.</p>
<pre class="r"><code>gs_result &lt;- read_html(search_page)</code></pre>
<p>This gives us a whole bunch of html that is largely useless. If you go to the <a href="https://scholar.google.com/citations?hl=en&amp;view_op=search_authors&amp;mauthors=root,leslie">search page</a>, you’ll notice that the bit we want is “Postdoctoral Fellow, University of California, Berkeley”. We can extract this from the html using the following code:</p>
<pre class="r"><code>affiliation &lt;- gs_result %&gt;% 
    xml_find_all(&quot;//div[contains(@class, &#39;gs_ai_aff&#39;)]&quot;) %&gt;% 
    html_text()</code></pre>
<p>Note that I worked out what bit I had to extract (the <code>gs_ai_aff</code>) by going to the search page, right clicking and selecting ‘View Page Source’, then searching for the bit that contained the affiliation.</p>
<p>Now that I have an automated way of grabbing the affiliation, I can iterate over the list of all scholars to get affiliations for everyone. A few things to note here: firstly, some people didn’t have Google Scholar pages, so I entered them manually. Secondly, affiliations are self-reported and so are often in different formats, so there was a bit of text cleaning to get a standardized form. Finally, some people have names that returned more than one Google Scholar page. For these people I searched the pages to find the one that included the paper(s) that I have listed for that particular scholar.</p>
</div>
<div id="geocoding-the-affiliation-locations" class="section level1">
<h1>Geocoding the affiliation locations</h1>
<p>Now that I have a list of affiliations, the next step is to geocode them so I can put them on a map. This may sound fancy but it’s very easy in R with the help of specialized packages. There are lots of geocoding packages around, but I used <code>tidygeocoder</code>. The <code>geocode</code> function within this package takes a tibble of addresses (which can just be University names) and returns a tibble with a latitude and longitude column. For example:</p>
<pre class="r"><code>geo_example &lt;- tibble(clean_affiliation = &quot;University of California, Berkeley&quot;)

geo_example %&gt;% 
  geocode(address = clean_affiliation, 
          method = &#39;osm&#39;, verbose = TRUE)</code></pre>
<pre><code>## # A tibble: 1 x 3
##   clean_affiliation                    lat  long
##   &lt;chr&gt;                              &lt;dbl&gt; &lt;dbl&gt;
## 1 University of California, Berkeley  37.9 -122.</code></pre>
<p>This worked great for the majority of affiliations I had listed. Some could not be found which I went through and manually entered (there were about 6 I did this for). In addition, a couple of geocodes were wrong (for example, the University of Southampton was put in Singapore?!), and I manually changed these. I did a cursory check but if anyone sees any remaining errors let me know.</p>
</div>
<div id="mapping-the-affiliation-locations" class="section level1">
<h1>Mapping the affiliation locations</h1>
<p>Now we have the geocoded affiliations we can map them easily using <code>leaflet</code>. Here’s the map:</p>
<pre class="r"><code>leaflet() %&gt;% 
  addTiles() %&gt;% 
  addMarkers(lat = geos$lat, 
             lng = geos$long, 
             popup = geos$clean_affiliation)</code></pre>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addMarkers","args":[[39.0483540875325,38.93804505,54.74137702,33.42152185,37.99419895,-35.28121335,41.71737868,47.6232408,45.4497194,41.3810557,null,40.25501105,41.82687235,35.3151859,36.81387055,41.50138695,41.5035001,22.4202695,19.46362965,42.8154037,40.8079488,42.4507221,null,36.0001557,-19.87080308,30.44235995,38.90893925,23.10595622,40.70695261,42.36790855,52.51875685,47.47388303,47.51239822,null,39.1701218,48.9093087,47.65414367,28.54016675,39.29797355,22.32237535,45.75103623,51.51459135,51.5209537,55.7126504,54.0940121,53.3845884,45.50691775,52.08210333,40.72925325,54.98017505,42.0551164,40.00570905,-22.87615887,47.6183617,39.99171495,40.81107215,40.75329481,38.91582567,40.33867515,51.7532557,51.82151725,51.82151725,41.90357096,37.43131385,59.366141,43.03830645,29.83226515,68.4359288,63.82177625,40.7514695,42.59176143,4.63874255,-31.7704734,-30.03223766,45.4344957,40.7258695,45.4067382,41.3892781,50.6682538,51.52420305,53.52682,33.45205165,-23.56096405,49.25839375,34.06895655,33.97352755,37.8753497,33.6458956,34.41460245,52.1998523,-27.5950893,41.7913505,40.00687815,39.7428324,51.8790698,46.1935215,53.21967825,29.7207902,38.99203005,42.3869382,-37.7970796,42.2942142,44.97780325,45.49524405,45.94553025,35.90503535,35.90503535,51.75870755,39.9493382,-27.49741805,51.4412092,52.13316322,53.3815327,33.9928298,50.93556897,34.0218833,55.3679132,56.3398198,56.1451154,30.2852198,29.58333105,43.66372992,46.0661497,60.45596125,48.2131284,-37.7858739,52.23784315,47.6543238,43.00874455,43.07982815,38.8936954,41.75246665,36.14380105,43.667176,48.2146757,51.98544495,38.64724015,39.27978885,50.9287084,38.89915437,41.25713055],[-77.12746719,-77.08939224,4.889828167,-111.9331616,23.73247909,149.1167789,-72.59615353,-122.3462039,9.188708076,-83.6296737,null,-111.6496566,-71.40122771,-120.6530585,-119.7446221,-81.60070216,2.1056374,114.2078634,-98.90545204,-75.53958156,-73.96179736,-76.48620433,null,-78.94422972,-43.9682938,-84.29747867,-77.07457962,72.53447197,-74.00652748,-71.12678237,13.39356049,19.07400844,19.03069308,null,-86.5260978,2.366383062,-122.3116884,77.16456005,-76.58991739,39.11736714,4.837669353,-0.116430658,-0.130371436,13.21075866,12.1111115,-6.6007526,-73.57911626,4.315500946,-73.99625394,-1.614680213,-87.67581113,-83.02866466,-43.24366562,-122.3394868,116.303935,-77.87708334,-73.96862735,-77.04532346,-74.65836549,-1.251292741,5.863403443,5.863403443,12.51430965,-122.1693654,18.05959296,-76.13330883,-95.0645226,17.43501933,20.30431631,-73.969586,-8.324261183,-74.08523776,-52.33988055,-51.22081313,12.3264484,8.560047492,11.87739374,2.191105535,4.620109527,-0.133000724,-113.5244937,-112.0636789,-46.72770807,-123.2465816,-118.4449665,-117.3288369,-122.2396336,-117.842799,-119.84581,0.119738657,-48.6159301,-87.60084269,-105.272776,-105.0059152,0.945054,6.1515108,6.562514822,-95.34406271,-76.9461029,-72.52991477,144.9613013,-83.71003894,-93.23325103,-73.57849928,-66.64018313,-79.04775327,-79.04775327,-1.255668483,-75.18964403,153.0131696,-0.9453854,-106.6317444,-1.4806602,-81.02685166,-1.394085702,-118.2858673,10.42815516,-2.811793705,-3.917393804,-97.73389273,-98.61944505,-79.3956564,11.11662319,22.28600076,16.36068599,175.3167665,21.01726259,-122.3080089,-81.27855855,-89.43066425,-77.0313398,-111.8088345,-86.80281889,-79.3932816,16.405203,5.663215777,-90.30840173,-80.3438921,10.3985863,-77.04243536,-72.9896696],null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},["Abt Associates","American University","Amsterdam University Medical Centers","Arizona State University","Athens University of Economics and Business","Australian National University","Avenir Health","Bill and Melinda Gates Foundation","Bocconi University","Bowling Green State University","Brazilian Institute of Geography and Statistics","Brigham Young University","Brown University","Cal Poly","California State University, Fresno","Case Western Reserve University","Centre d'Estudis Demografics","Chinese University of Hong Kong","Colegio de Postgraduados","Colgate University","Columbia University","Cornell University","Danish National Archives","Duke University","Universidade Federal de Minas Gerais","Florida State University","Georgetown University","Gujurat Institute of Development Research","Guttmacher Institute","Harvard University","Humboldt-University Berlin","The Institute for Sociology, Centre for Social Sciences of the Hungarian Academy of Sciences","Hungarian Demographic Research Institute","ICF international","Indiana University","Institut national d'études démographiques (INED)","Institute for Health Metrics and Evaluation","Jawaharlal Nehru University","Johns Hopkins Bloomberg School of Public Health","King Abdullah University of Science and Technology","Laboratoire de Recherche Historique Rhone-Alpes","London School of Economics","London School of Hygiene and Tropical Medicine","Lund University","Max Planck Institute for Demographic Research","Maynooth University","McGill University","Netherlands Interdisciplinary Demographic Institute","New York University","Newcastle University","Northwestern University","Ohio State University","Oswaldo Cruz Foundation","PATH Seattle","Peking University","Pennsylvania State University","Population Council","Population Reference Bureau","Princeton University","Queens College","Radboud University","Radboud University Nijmegen","Sapienza University of Rome","Stanford University","Stockholm University","Syracuse University","The University of Texas Medical Branch","UiT The Arctic University of Norway","Umeå University","United Nations Population Division","Universidad de Vigo","Universidad Nacional de Colombia-Bogota","Universidade Federal de Pelotas","Universidade Federal do Rio Grande do Sul","Universita Ca' Foscari Venezia","Universita degli Studi di Sassari","Universita' di Padova","Universitat Pompeu Fabra","Universite Catholique de Louvain","University College London","University of Alberta","University of Arizona","University of Brasilia","University of British Columbia","University of California, Los Angeles","University of California, Riverside","University of California, Berkeley","University of California, Irvine","University of California, Santa Barbara","University of Cambridge","University of Campinas","University of Chicago","University of Colorado Boulder","University of Colorado Denver","University of Essex","University of Geneva","University of Groningen","University of Houston","University of Maryland","University of Massachusetts Amherst","University of Melbourne","University of Michigan","University of Minnesota","University of Montreal","University of New Brunswick","University of North Carolina","University of North Carolina at Chapel Hill","University of Oxford","University of Pennsylvania","University of Queensland","University of Reading","University of Saskatchewan","University of Sheffield","University of South Carolina","University of Southampton","University of Southern California","University of Southern Denmark","University of St Andrews","University of Stirling","University of Texas at Austin","University of Texas at San Antonio","University of Toronto","University of Trento","University of Turku","University of Vienna","University of Waikato","University of Warsaw","University of Washington","University of Western Ontario","University of Wisconsin-Madison","USAID","Utah State University","Vanderbilt University","Victoria University","Vienna Institute of Demography","Wageningen University & Research","Washington University in St. Louis","West Virginia University","Wittgenstein Centre","World Bank","Yale University"],null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[-37.7970796,68.4359288],"lng":[-123.2465816,175.3167665]}},"evals":[],"jsHooks":[]}</script>
<p>There are 141 unique affiliations. Perhaps unsurprisingly these are very much concentrated in the US and Europe.</p>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<p>I created a list of women in demography and stupidly did not record affiliations. But it was a nice excuse to use some nice R packages like <code>rvest</code> and <code>tidygeocoder</code> to get a map of this network so far. Hopefully this list will continue to grow over time; please add yourself or others if you see omissions!</p>
</div>
